<!DOCTYPE html>
<html>
<head>
<title>Reagent Tutorial</title>
<!-- 2015-08-02 -->
<meta  charset="utf-8">
<meta  name="generator" content="Org-mode">
<meta  name="author" content="Wang Menglei">
<link rel="Stylesheet" type="text/css" href="assets/css/style.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript">
    function show_org_source(){
       /* document.location.href = rpl(document.location.href,"html","org.html"); */
       var url = document.location.href.split('#')[0];
       document.location.href = url.replace(/.html$/, '.org.html');
    }
</script>
</head>
<body>
<div id="preamble" class="status">
<!--<body onload="prettyPrint()">-->
<nav>
    <a href="index.html">Index</a>
    <a href="about.html">About</a>
    <a href="https://lotabout.github.io">Blog</a>
    <a href="sitemap.html">SiteMap</a>
</nav>
</div>
<div id="content">
<h1 class="title">Reagent Tutorial</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Create the testing project</a></li>
<li><a href="#sec-2">Walk through the tutorial</a>
<ul>
<li><a href="#sec-2-1">Your first component</a></li>
<li><a href="#sec-2-2">Composing components</a></li>
<li><a href="#sec-2-3">Using Props</a>
<ul>
<li><a href="#sec-2-3-1">Reagent's Components As Functions</a></li>
<li><a href="#sec-2-3-2">A Little Test of Reagent's Props</a></li>
<li><a href="#sec-2-3-3">A Simple Conclusion of Props in Reagent</a></li>
<li><a href="#sec-2-3-4">A Test Combination of Props and Functions</a></li>
</ul>
</li>
<li><a href="#sec-2-4">Hook up the data model</a></li>
<li><a href="#sec-2-5">Reactive state</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
This artical is a walkthrough of React.js quickstart tutorial using Reagent.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Create the testing project</h2>
<div class="outline-text-2" id="text-1">
<p>
Use the <code>reagent</code> template by:
</p>

<div class="org-src-container">

<pre class="src src-sh">lein new reagent reagent-tutorial
</pre>
</div>

<p>
Now start figwheel to enable auto compilation of cljs codes and auto
reload js code to our page.
</p>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #8cd0d3;">cd</span> reagent-tutorial
lein figwheel
</pre>
</div>

<p>
After starting it up, we open the page at <a href="http://localhost:3449/">http://localhost:3449/</a>,
and see the page containing "Welcome to reagent-tutorial".
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Walk through the tutorial</h2>
<div class="outline-text-2" id="text-2">
<p>
The react.js quick-start tutorial is
<a href="https://facebook.github.io/react/docs/tutorial.html">https://facebook.github.io/react/docs/tutorial.html</a>.
</p>

<p>
We are trying to implement the functions in Reagent.
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Your first component</h3>
<div class="outline-text-3" id="text-2-1">
<p>
We build a <code>CommentBox</code> component:
</p>
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #7f9f7f;">// </span><span style="color: #7f9f7f;">tutorial1.js</span>
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">CommentBox</span> = React.createClass({
  <span style="color: #8cd0d3;">render</span>: <span style="color: #f0dfaf; font-weight: bold;">function</span>() {
    <span style="color: #f0dfaf; font-weight: bold;">return</span> (
      &lt;div className=<span style="color: #cc9393;">"commentBox"</span>&gt;
        <span style="color: #dfaf8f;">Hello</span>, <span style="color: #dfaf8f;">world</span>! <span style="color: #dfaf8f;">I</span> <span style="color: #dfaf8f;">am</span> <span style="color: #dfaf8f;">a</span> <span style="color: #dfaf8f;">CommentBox</span>.
      &lt;/div&gt;
    );
  }
});
React.render(
  &lt;CommentBox /&gt;,
  document.getElementById(<span style="color: #cc9393;">'content'</span>)
);
</pre>
</div>

<p>
Open the <code>core.cljs</code> file in <code>src/cljs/reagent_tutorial</code> directory.
</p>

<p>
First we create a corresonding comment box:
</p>
<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-box</span> []
  [<span style="color: #bfebbf;">:div.commentBox</span>
   <span style="color: #cc9393;">"Hello, world! I am a CommentBox."</span>])
</pre>
</div>

<p>
And modify the render function <code>mount-root</code> to:
</p>
<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">mount-root</span> []
    (<span style="color: #8cd0d3;">reagent</span>/render [comment-box] (<span style="color: #8cd0d3;">.getElementById</span> <span style="color: #8cd0d3;">js</span>/document <span style="color: #cc9393;">"app"</span>)))
</pre>
</div>

<p>
And You should see that the page's content had chaned to "Hello, world! I am a CommentBox.".
</p>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Composing components</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Now we are tring to build the skeletons for <code>CommentList</code> and <code>CommentForm</code>.
</p>
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #7f9f7f;">// </span><span style="color: #7f9f7f;">tutorial2.js</span>
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">CommentList</span> = React.createClass({
  <span style="color: #8cd0d3;">render</span>: <span style="color: #f0dfaf; font-weight: bold;">function</span>() {
    <span style="color: #f0dfaf; font-weight: bold;">return</span> (
      &lt;div className=<span style="color: #cc9393;">"commentList"</span>&gt;
        <span style="color: #dfaf8f;">Hello</span>, <span style="color: #dfaf8f;">world</span>! <span style="color: #dfaf8f;">I</span> <span style="color: #dfaf8f;">am</span> <span style="color: #dfaf8f;">a</span> <span style="color: #dfaf8f;">CommentList</span>.
      &lt;/div&gt;
    );
  }
});

<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">CommentForm</span> = React.createClass({
  <span style="color: #8cd0d3;">render</span>: <span style="color: #f0dfaf; font-weight: bold;">function</span>() {
    <span style="color: #f0dfaf; font-weight: bold;">return</span> (
      &lt;div className=<span style="color: #cc9393;">"commentForm"</span>&gt;
        <span style="color: #dfaf8f;">Hello</span>, <span style="color: #dfaf8f;">world</span>! <span style="color: #dfaf8f;">I</span> <span style="color: #dfaf8f;">am</span> <span style="color: #dfaf8f;">a</span> <span style="color: #dfaf8f;">CommentForm</span>.
      &lt;/div&gt;
    );
  }
});

<span style="color: #7f9f7f;">// </span><span style="color: #7f9f7f;">tutorial3.js</span>
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">CommentBox</span> = React.createClass({
  <span style="color: #8cd0d3;">render</span>: <span style="color: #f0dfaf; font-weight: bold;">function</span>() {
    <span style="color: #f0dfaf; font-weight: bold;">return</span> (
      &lt;div className=<span style="color: #cc9393;">"commentBox"</span>&gt;
        &lt;h1&gt;Comments&lt;/h1&gt;
        &lt;CommentList /&gt;
        &lt;CommentForm /&gt;
      &lt;/div&gt;
    );
  }
});
</pre>
</div>

<p>
And change them to corresonding reagent (nothing to explain):
</p>

<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-list</span> []
  [<span style="color: #bfebbf;">:div.commentList</span>
   <span style="color: #cc9393;">"Hello, world! I am a CommentList"</span>])

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-form</span> []
  [<span style="color: #bfebbf;">:div.commentForm</span>
   <span style="color: #cc9393;">"Hello, world! I am a CommentForm"</span>])

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-box</span> []
  [<span style="color: #bfebbf;">:div.commentBox</span>
   [<span style="color: #bfebbf;">:h1</span> <span style="color: #cc9393;">"Comments"</span>]
   [comment-list] 
   [comment-form]])
</pre>
</div>

<p>
Done, the page should be updated automatically(all hail figwheel).
</p>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Using Props</h3>
<div class="outline-text-3" id="text-2-3">
<p>
We can pass information from the parent node to child node, which is
called props in child. So when we want to construct a <code>Comment</code>, we
can specify the information it needed: author and content:
</p>

<div class="org-src-container">

<pre class="src src-js"><span style="color: #7f9f7f;">// </span><span style="color: #7f9f7f;">tutorial4.js</span>
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">Comment</span> = React.createClass({
  <span style="color: #8cd0d3;">render</span>: <span style="color: #f0dfaf; font-weight: bold;">function</span>() {
    <span style="color: #f0dfaf; font-weight: bold;">return</span> (
      &lt;div className=<span style="color: #cc9393;">"comment"</span>&gt;
        &lt;h2 className=<span style="color: #cc9393;">"commentAuthor"</span>&gt;
          {<span style="color: #bfebbf;">this</span>.props.author}
        &lt;/h2&gt;
        {<span style="color: #bfebbf;">this</span>.props.children}
      &lt;/div&gt;
    );
  }
});
</pre>
</div>

<p>
And we can specify the information(props) via:
</p>

<div class="org-src-container">

<pre class="src src-js"><span style="color: #7f9f7f;">// </span><span style="color: #7f9f7f;">tutorial5.js</span>
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">CommentList</span> = React.createClass({
  <span style="color: #8cd0d3;">render</span>: <span style="color: #f0dfaf; font-weight: bold;">function</span>() {
    <span style="color: #f0dfaf; font-weight: bold;">return</span> (
      &lt;div className=<span style="color: #cc9393;">"commentList"</span>&gt;
        &lt;Comment author=<span style="color: #cc9393;">"Pete Hunt"</span>&gt;This is one comment&lt;/Comment&gt;
        &lt;Comment author=<span style="color: #cc9393;">"Jordan Walke"</span>&gt;This is *another* comment&lt;/Comment&gt;
      &lt;/div&gt;
    );
  }
});
</pre>
</div>

<p>
First, note the props are accessed by <code>this.props</code>. Second, the
<code>props</code> contains a special item called <code>props.children</code> which refer to
the wrapped content in the parent.
</p>
</div>

<div id="outline-container-sec-2-3-1" class="outline-4">
<h4 id="sec-2-3-1">Reagent's Components As Functions</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
As we had seen, the components in reagent are just like functions in
clojure. So there better be a way to specify the props.
</p>

<p>
The first one is abstract it like function called.
</p>
<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-item</span> [author &amp; children]
  (into [<span style="color: #bfebbf;">:div.comment</span>
         [<span style="color: #bfebbf;">:h2.commentAuthor</span> author]]
        children))

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-list</span> []
  [<span style="color: #bfebbf;">:div.commentList</span>
   [comment-item <span style="color: #cc9393;">"Pete Hunt"</span> <span style="color: #cc9393;">"This is one comment"</span>]
   [comment-item <span style="color: #cc9393;">"Jordan Walke"</span> <span style="color: #cc9393;">"This is *another* comment"</span>]])
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-3-2" class="outline-4">
<h4 id="sec-2-3-2">A Little Test of Reagent's Props</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
According to
<a href="https://reagent-project.github.io/news/any-arguments.html">Reagent
News</a>, the function conversion described above was introduced recently. 
</p>

<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">ns</span> <span style="color: #8cd0d3;">example</span>
    (<span style="color: #bfebbf;">:require</span> [<span style="color: #8cd0d3;">reagent.core</span> <span style="color: #bfebbf;">:as</span> r <span style="color: #bfebbf;">:refer</span> [atom]]))

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">my-div</span> []
  (<span style="color: #f0dfaf; font-weight: bold;">let</span> [this (<span style="color: #8cd0d3;">reagent</span>/current-component)]
    (into [<span style="color: #bfebbf;">:div.custom</span> (<span style="color: #8cd0d3;">reagent</span>/props this)]
          (<span style="color: #8cd0d3;">reagent</span>/children this))))

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">call-my-div</span> []
  [<span style="color: #bfebbf;">:div</span>
   [my-div <span style="color: #cc9393;">"Some text."</span>]
   [my-div {<span style="color: #bfebbf;">:style</span> {<span style="color: #bfebbf;">:font-weight</span> 'bold}}
    [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"Some other text in bold."</span>]
    [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"some other text"</span>]]])
</pre>
</div>

<p>
So now <code>(reagent/props this)</code> will be the map <code>{:style {:font-weight
'bold}}</code>, and <code>(reagent/children this)</code> will be a list of two
components: <code>[[:p "Some other text in bold."] [:p "some other
text"]]</code>. That is also the reason that we need to call <code>into</code> function
to concate two list.
</p>

<p>
Also, if you omit the properties in the caller like:
</p>
<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">call-my-div</span> []
  [<span style="color: #bfebbf;">:div</span>
   [my-div <span style="color: #cc9393;">"Some text."</span>]
   [my-div <span style="color: #7f9f7f;">; removed the properties here</span>
    [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"Some other text in bold."</span>]
    [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"some other text"</span>]]])
</pre>
</div>

<p>
The child simply got nothing(nil) calling to <code>(reagent/props this)</code>.
</p>

<p>
The syntax is a bit tedious, but works, right?
</p>

<p>
But what is we want to combine the properties and the convenience of
function calls? Now we write a component to check the result:
</p>

<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-item</span> [first-comp &amp; rest-comp]
  (<span style="color: #f0dfaf; font-weight: bold;">let</span> [this (<span style="color: #8cd0d3;">reagent</span>/current-component)]
    [<span style="color: #bfebbf;">:div</span>
     [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"The 'props' propertity: "</span> (str (<span style="color: #8cd0d3;">reagent</span>/props this))]
     [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"The first component: "</span> (str first-comp)]
     [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"The rest component: "</span> (str rest-comp)]
     [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"The children component: "</span> (str (<span style="color: #8cd0d3;">reagent</span>/children this))]]))
</pre>
</div>

<p>
And by using a map as the first argument:
</p>
<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-list</span> []
  [<span style="color: #bfebbf;">:div</span>
   [comment-item {<span style="color: #bfebbf;">:author</span> <span style="color: #cc9393;">"Your Name"</span>}
    [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"first component"</span>]
    [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"second component"</span>]]])
</pre>
</div>

<p>
The result is:
</p>
<pre class="example">
The 'props' propertity: {:author "Your Name"}
The first component: {:author "Your Name"}
The rest component: ([:p "first component"] [:p "second component"])
The children component: [[:p "first component"] [:p "second component"]]
</pre>

<p>
And by using a none-map as the first argument:
</p>
<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-list</span> []
  [<span style="color: #bfebbf;">:div</span>
   [comment-item <span style="color: #7f9f7f;">; note the map is deleted here</span>
    [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"first component"</span>]
    [<span style="color: #bfebbf;">:p</span> <span style="color: #cc9393;">"second component"</span>]]])
</pre>
</div>

<pre class="example">
The 'props' propertity:
The first component: [:p "first component"]
The rest component: ([:p "second component"])
The children component: [[:p "first component"] [:p "second component"]]
</pre>
</div>
</div>

<div id="outline-container-sec-2-3-3" class="outline-4">
<h4 id="sec-2-3-3">A Simple Conclusion of Props in Reagent</h4>
<div class="outline-text-4" id="text-2-3-3">
<ol class="org-ol">
<li>You can retrieve the properties using <code>(reagent/props component-reference)</code>.
</li>
<li>The <code>props</code> refers to the first parameter given by the caller/parent if it
is a map.
</li>
<li>The <code>children</code> refers to the list of parameters given by the
caller/parent other than the first parameter if it is a map.
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-2-3-4" class="outline-4">
<h4 id="sec-2-3-4">A Test Combination of Props and Functions</h4>
<div class="outline-text-4" id="text-2-3-4">
<p>
This can serve as an example when you really need the props, otherwise
use the component as functions would do all the goods. 
</p>

<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-item</span> [props &amp; children]
  [<span style="color: #bfebbf;">:div.comment</span>
   (into [<span style="color: #bfebbf;">:p.commentAuthor</span> {<span style="color: #bfebbf;">:style</span> (<span style="color: #bfebbf;">:style</span> props)} (<span style="color: #bfebbf;">:author</span> props)]
         children)])

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-list</span> []
  [<span style="color: #bfebbf;">:div.commentList</span>
   [comment-item {<span style="color: #bfebbf;">:author</span> <span style="color: #cc9393;">"Pete Hunt"</span>} <span style="color: #cc9393;">"This is one comment"</span>]
   [comment-item {<span style="color: #bfebbf;">:author</span> <span style="color: #cc9393;">"Jordan Walke"</span> <span style="color: #bfebbf;">:style</span> {<span style="color: #bfebbf;">:font-weight</span> 'bold}} <span style="color: #cc9393;">"This is *another* comment"</span>]])
</pre>
</div>

<p>
I personally thinks that you will need this only when you cannot
determine the number of properties you will use.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">Hook up the data model</h3>
<div class="outline-text-3" id="text-2-4">
<p>
We can pass data into components.
</p>
<div class="org-src-container">

<pre class="src src-js"><span style="color: #7f9f7f;">// </span><span style="color: #7f9f7f;">tutorial8.js</span>
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">data</span> = [
  {author: <span style="color: #cc9393;">"Pete Hunt"</span>, text: <span style="color: #cc9393;">"This is one comment"</span>},
  {author: <span style="color: #cc9393;">"Jordan Walke"</span>, text: <span style="color: #cc9393;">"This is *another* comment"</span>}
];

<span style="color: #7f9f7f;">// </span><span style="color: #7f9f7f;">tutorial9.js</span>
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">CommentBox</span> = React.createClass({
  <span style="color: #8cd0d3;">render</span>: <span style="color: #f0dfaf; font-weight: bold;">function</span>() {
    <span style="color: #f0dfaf; font-weight: bold;">return</span> (
      &lt;div className=<span style="color: #cc9393;">"commentBox"</span>&gt;
        &lt;h1&gt;Comments&lt;/h1&gt;
        &lt;CommentList data={<span style="color: #bfebbf;">this</span>.props.data} /&gt;
        &lt;CommentForm /&gt;
      &lt;/div&gt;
    );
  }
});

React.render(
  &lt;CommentBox data={data} /&gt;,
  document.getElementById(<span style="color: #cc9393;">'content'</span>)
);

<span style="color: #7f9f7f;">// </span><span style="color: #7f9f7f;">tutorial10.js</span>
<span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">CommentList</span> = React.createClass({
  <span style="color: #8cd0d3;">render</span>: <span style="color: #f0dfaf; font-weight: bold;">function</span>() {
    <span style="color: #f0dfaf; font-weight: bold;">var</span> <span style="color: #dfaf8f;">commentNodes</span> = <span style="color: #bfebbf;">this</span>.props.data.map(<span style="color: #f0dfaf; font-weight: bold;">function</span> (<span style="color: #dfaf8f;">comment</span>) {
      <span style="color: #f0dfaf; font-weight: bold;">return</span> (
        &lt;Comment author={comment.author}&gt;
          {comment.text}
        &lt;/Comment&gt;
      );
    });
    <span style="color: #f0dfaf; font-weight: bold;">return</span> (
      &lt;div className=<span style="color: #cc9393;">"commentList"</span>&gt;
        {commentNodes}
      &lt;/div&gt;
    );
  }
});
</pre>
</div>

<p>
We pass the data from the top <code>CommentBox</code> and pass the data to its
children accordingly. In reagent, this can be implemented smoothly.
</p>

<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">def</span> <span style="color: #dfaf8f;">data</span> [{<span style="color: #bfebbf;">:author</span> <span style="color: #cc9393;">"Pete Hunt"</span>, <span style="color: #bfebbf;">:text</span> <span style="color: #cc9393;">"This is one comment"</span>}
           {<span style="color: #bfebbf;">:author</span> <span style="color: #cc9393;">"Jordan Walke"</span>, <span style="color: #bfebbf;">:text</span> <span style="color: #cc9393;">"This is *another* comment"</span>}])

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-item</span> [author &amp; children]
    (into [<span style="color: #bfebbf;">:div.comment</span>
           [<span style="color: #bfebbf;">:h2.commentAuthor</span> author]]
          children))

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-list</span> [data]
  [<span style="color: #bfebbf;">:div.commentList</span>
   (<span style="color: #f0dfaf; font-weight: bold;">for</span> [comment data]
     [comment-item (<span style="color: #bfebbf;">:author</span> comment) (<span style="color: #bfebbf;">:text</span> comment)])])

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-form</span> []
  [<span style="color: #bfebbf;">:div.commentForm</span>
   <span style="color: #cc9393;">"Hello, world! I am a CommentForm"</span>])

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-box</span> [data]
  [<span style="color: #bfebbf;">:div.commentBox</span>
   [<span style="color: #bfebbf;">:h1</span> <span style="color: #cc9393;">"Comments"</span>]
   [comment-list data] 
   [comment-form]])

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">mount-root</span> []
    (<span style="color: #8cd0d3;">reagent</span>/render [comment-box data] (<span style="color: #8cd0d3;">.getElementById</span> <span style="color: #8cd0d3;">js</span>/document <span style="color: #cc9393;">"app"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">Reactive state</h3>
<div class="outline-text-3" id="text-2-5">
<p>
The original document says a lot about AJAX calls to fetch the data, I
found it irrelevant to React.js. So I'll only explain the following
things:
</p>

<ol class="org-ol">
<li>The state in React.js are represented as 'Atom' in Reagent
</li>
<li>According to <a href="https://github.com/reagent-project/reagent">reagent
doc</a>, you can return a new function while defining components, so
as to avoid usage of <code>getInitialState</code> and <code>componentDidMount</code>.
</li>
</ol>

<p>
Make change to <code>comment-box</code> and <code>comment-list</code>
</p>
<div class="org-src-container">

<pre class="src src-clojure">(<span style="color: #f0dfaf; font-weight: bold;">ns</span> <span style="color: #8cd0d3;">reagent-tutorial.core</span>
    (<span style="color: #bfebbf;">:require</span> [<span style="color: #8cd0d3;">reagent.core</span> <span style="color: #bfebbf;">:as</span> reagent <span style="color: #bfebbf;">:refer</span> [atom]]))

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-box</span> []
  (<span style="color: #f0dfaf; font-weight: bold;">let</span> [data (atom data)]
    <span style="color: #7f9f7f;">;; </span><span style="color: #7f9f7f;">you can add ajax callback here</span>
    (<span style="color: #f0dfaf; font-weight: bold;">fn</span> []
      [<span style="color: #bfebbf;">:div.commentBox</span>
       [<span style="color: #bfebbf;">:h1</span> <span style="color: #cc9393;">"Comments"</span>]
       [comment-list data] 
       [comment-form]])))

(<span style="color: #f0dfaf; font-weight: bold;">defn</span> <span style="color: #8cd0d3;">comment-list</span> [data]
  [<span style="color: #bfebbf;">:div.commentList</span>
   (<span style="color: #f0dfaf; font-weight: bold;">for</span> [comment @data]
     [comment-item (<span style="color: #bfebbf;">:author</span> comment) (<span style="color: #bfebbf;">:text</span> comment)])])
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<a href="#" class="back-to-top">Back to Top</a>

<!-- <hr class="comment"> -->
<!-- <div id="show_source"> -->
<!--   <input type="button" value="Show Org source" onClick='show_org_source()'> -->
<!-- </div> -->

</script>
<hr class="comment">
<section class="comment">
<!-- An element a visitor can click if they <3 comments! -->
<button class="btn show-comments">Load Disqus comments</button>
<div id="disqus_thread"></div>
 
<!-- The empty element required for Disqus to loads comments into -->
<!--<div id="disqus_thread"></div>-->
    <!--<script type="text/javascript">-->
        <!--/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */-->
        <!--var disqus_shortname = 'lotaboutvimwiki'; // required: replace example with your forum shortname-->

        <!--/* * * DON'T EDIT BELOW THIS LINE * * */-->
        <!--(function() {-->
            <!--var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;-->
            <!--dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';-->
            <!--(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);-->
        <!--})();-->
    <!--</script>-->
    <!--<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>-->
</section>

<footer>
    |采用<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">CC BY-NC-SA 3.0</a>授权|由<a href="http://orgmode.org">Org Mode</a>自动生成<input type="button" value="Show Org source" onClick='show_org_source()'>|部署在<a href="https://github.com/lotabout/orgwiki">Github Pages</a>|
</footer>

    <script src="assets/js/jquery-1.7.1.min.js"></script>
    <script>
$(document).ready(function(){
	var offset = 100;
	var duration = 110;

        $(window).resize(function () {
            var toc= $('#table-of-contents')
            if ($(window).width() <= 800) {
                toc.css('position', 'static')
	        return
            }
            });
        $(window).scroll(
            function () {
            console.log("scroll called.")
            var toc= $('#table-of-contents')
            if ($(window).width() <= 800) {
            toc.css('position', 'static')
            return
            }

            if ($(this).scrollTop() > duration) {
            toc.css('left', toc.position().left + 'px')
            toc.css('position', 'fixed')
            $('.back-to-top').fadeIn(duration);
            } else {
            toc.css('left', '0px')
            toc.css('top', '0px')
            toc.css('position', 'relative')
            $('.back-to-top').fadeOut(duration);
            }
            });
        $('.back-to-top').click(
            function(event) {
            event.preventDefault;
            $('html, body').animate({scrollTop: 0}, duration);
            return false;
            });

        $('.show-comments').on('click', function(){
                               var disqus_shortname = 'lotaboutorgwiki'; // Replace this value with *your* username.

                               // ajax request to load the disqus javascript
                               $.ajax({
type: "GET",
url: "http://" + disqus_shortname + ".disqus.com/embed.js",
dataType: "script",
cache: true
});
                               // hide the button once comments load
                               $(this).fadeOut();
                               });
});
    </script>
</div>
</body>
</html>
